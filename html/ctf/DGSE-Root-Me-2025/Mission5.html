

<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mission 5 &mdash; Documentation Kubow WU 1</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=a12a2fe1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/translations.js?v=e6b791cb"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="Mission finale" href="Mission-finale.html" />
    <link rel="prev" title="Mission 4" href="Mission4.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Kubow WU
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Capture The Flag (CTF)</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../midnightflag-2024/_index.html">MidNight Flag CTF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../midnightflag-2025/_index.html">Midnight Flag 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../404ctf-2024/_index.html">404CTF 2024</a></li>
<li class="toctree-l1"><a class="reference internal" href="../404ctf-2025/_index.html">404CTF 2025</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FCSC-2025/_index.html">FCSC 2025</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="_index.html">DGSE Root-Me 2025</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Mission1.html">Mission 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mission2.html">Mission 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mission3.html">Mission 3</a></li>
<li class="toctree-l2"><a class="reference internal" href="Mission4.html">Mission 4</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mission 5</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enonce">Enoncé</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#brief-de-mission">Brief de mission</a></li>
<li class="toctree-l4"><a class="reference internal" href="#objectifs-de-la-mission">Objectifs de la mission</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#exploit">Exploit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Mission-finale.html">Mission finale</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Hackosint-2025/_index.html">Hackosint 2025</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Kubow WU</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="_index.html">DGSE Root-Me 2025</a></li>
      <li class="breadcrumb-item active">Mission 5</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/ctf/DGSE-Root-Me-2025/Mission5.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mission-5">
<h1>Mission 5<a class="headerlink" href="#mission-5" title="Lien vers cette rubrique"></a></h1>
<section id="enonce">
<h2>Enoncé<a class="headerlink" href="#enonce" title="Lien vers cette rubrique"></a></h2>
<section id="brief-de-mission">
<h3>Brief de mission<a class="headerlink" href="#brief-de-mission" title="Lien vers cette rubrique"></a></h3>
<p>Lors d’une arrestation au domicile d’un des attaquants précédemment identifiés, l’équipe a saisi une vielle tablette Google utilisée pour leurs communications.
Durant son analyse, une application de chat semble être chiffrée, rendant impossible l’accès et la découverte de son contenu.</p>
</section>
<section id="objectifs-de-la-mission">
<h3>Objectifs de la mission<a class="headerlink" href="#objectifs-de-la-mission" title="Lien vers cette rubrique"></a></h3>
<p>Analyser l’application mobile.
Accéder aux informations chiffrées.</p>
</section>
</section>
<section id="exploit">
<h2>Exploit<a class="headerlink" href="#exploit" title="Lien vers cette rubrique"></a></h2>
<p>On va décompiler l’application avec mobSF</p>
<p>On trouve rapidement des informations intéressantes :</p>
<ul class="simple">
<li><p>Un serveur API : private static final String BASE_URL = « <a class="reference external" href="http://163.172.67.201:8000/">http://163.172.67.201:8000/</a> »;</p></li>
<li><p>Une route de l’API :</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">@GET(&quot;messages&quot;)</span>
<span class="go">Object getMessages(@Query(&quot;id&quot;) String str, Continuation&lt;? super Response&lt;ApiResponse&gt;&gt; continuation);</span>
</pre></div>
</div>
<p>Si on se rend sur la route <a class="reference external" href="http://163.172.67.201:8000/messages?id=1">http://163.172.67.201:8000/messages?id=1</a> on obtient ceci :</p>
<p>A priori les messages à déchiffrer :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">{</span>
<span class="go">&quot;messages&quot;: [</span>
<span class="go">    {</span>
<span class="go">    &quot;content&quot;: &quot;M2geCVKOzPlyug9p9DvthxPip0oe9BPiT2sDfFhWy7iC3+JQI4SfO7+SLAlFSUmu8LoGj1hrUWil/uNXvc+5mKBMrRNFQT8ijBK14P0Z8qA=&quot;,</span>
<span class="go">    &quot;isEncrypted&quot;: true,</span>
<span class="go">    &quot;sender&quot;: &quot;Agent-02&quot;,</span>
<span class="go">    &quot;timestamp&quot;: &quot;2025-04-01 08:00:00&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">    &quot;content&quot;: &quot;//5PBsYWhHlgqhVgG1omUyevzmlErLZVsTCLO78Rbb9qBMPnsKCS5/RZ4GEdWRBPiZ4BtO5h7j2PuIutfqf7ag==&quot;,</span>
<span class="go">    &quot;isEncrypted&quot;: true,</span>
<span class="go">    &quot;sender&quot;: &quot;Agent-1337&quot;,</span>
<span class="go">    &quot;timestamp&quot;: &quot;2025-04-01 10:00:00&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">    &quot;content&quot;: &quot;2uNMSnJZa5JExhYgNA+V3RAiafhuLkj8Jnr4U+lSZOrrpMWjyA13w0Do3IIPcVBgK070rmweRKX/GkCAxat4i3JfWk1UvWNSmEZbHQlFznR7VFW6FKK84iJKhiDOp8Tk&quot;,</span>
<span class="go">    &quot;isEncrypted&quot;: true,</span>
<span class="go">    &quot;sender&quot;: &quot;Agent-01&quot;,</span>
<span class="go">    &quot;timestamp&quot;: &quot;2025-04-02 15:30:00&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">    &quot;content&quot;: &quot;Swz/ycaTlv3JM9iKJHaY+f1SRyKvfQ5miG6I0/tUb8bvbOO+wyU5hi+bGsmcJD3141FrmrDcBQhtWpYimospymABi3bzvPPi01rPI8pNBq8=&quot;,</span>
<span class="go">    &quot;isEncrypted&quot;: true,</span>
<span class="go">    &quot;sender&quot;: &quot;Agent-02&quot;,</span>
<span class="go">    &quot;timestamp&quot;: &quot;2025-04-03 13:20:00&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">    &quot;content&quot;: &quot;NAe44oieygG7xzLQT3j0vN+0NoPNUu0TAaid9Az3IlpcKwR0lSKaPT8F4y1zpbArWFIGpgzsPZtPAwL50qocTRMG/g5u+/wcc1nxmhBjCbg=&quot;,</span>
<span class="go">    &quot;isEncrypted&quot;: true,</span>
<span class="go">    &quot;sender&quot;: &quot;Agent-04&quot;,</span>
<span class="go">    &quot;timestamp&quot;: &quot;2025-04-04 08:30:00&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">    &quot;content&quot;: &quot;dfeKlZP/gIntHySBYine2YUlNiX3LjlMOLu7y9tgprFyJIIcQpfghlQXut6cJUG2wtzGBVQUm7ITdpLNeVaZjamQHhPWEtNIJE/xtFg66Klui1qCKYKSrmZ4wm1CG/ZPy4csqbM28Ur8dts7XoV5FA==&quot;,</span>
<span class="go">    &quot;isEncrypted&quot;: true,</span>
<span class="go">    &quot;sender&quot;: &quot;Agent-04&quot;,</span>
<span class="go">    &quot;timestamp&quot;: &quot;2025-04-05 16:45:00&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">    &quot;content&quot;: &quot;HgVONjPe9UpULkg8e9Ps5++m3t4r6RK0pPfMUQJK/Ok5NinC3UJqkltlEukrvehfyas/uOQygGwMFYdRWT6m4gQBq/TdHf9Xpf4kLJl+o9l2shuwBGFpayRLMkRZ0yX1&quot;,</span>
<span class="go">    &quot;isEncrypted&quot;: true,</span>
<span class="go">    &quot;sender&quot;: &quot;Agent-03&quot;,</span>
<span class="go">    &quot;timestamp&quot;: &quot;2025-04-06 11:15:00&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">    &quot;content&quot;: &quot;M+bWr4Az5IbaOw4oGRKZ0pWrGjK7hhLeXVpOiaOAFw91v8KGwhl5b6bXoEl3qqz5APuiy9gLQp7x7GGDod4mLOBWRby48g2RjABqGa6mg3g=&quot;,</span>
<span class="go">    &quot;isEncrypted&quot;: true,</span>
<span class="go">    &quot;sender&quot;: &quot;Agent-01&quot;,</span>
<span class="go">    &quot;timestamp&quot;: &quot;2025-04-06 14:20:00&quot;</span>
<span class="go">    },</span>
<span class="go">    {</span>
<span class="go">    &quot;content&quot;: &quot;Z56plvPjUwczUuTZajCJNqvxB0ArZ9vk38PJnGHSlayR6xe9la8wB4sMOdChcOozbXsjwMRY78wuogxsY57R3iiKe1O3nDpwt3y85BXl9sLEF15wZ8wxc5IfpjVUnRJT&quot;,</span>
<span class="go">    &quot;isEncrypted&quot;: true,</span>
<span class="go">  &quot;sender&quot;: &quot;Agent-00&quot;,</span>
<span class="go">  &quot;timestamp&quot;: &quot;2025-04-07 09:00:00&quot;</span>
<span class="go">        }</span>
<span class="go">    ]</span>
<span class="go">}</span>
</pre></div>
</div>
<p>Mais coment faire ?</p>
<p>On trouve également dans le code :</p>
<ul class="simple">
<li><p>Un SALT : private static final String STATIC_SALT = « <a class="reference external" href="mailto:s3cr3t_s&#37;&#52;&#48;lt">s3cr3t_s<span>&#64;</span>lt</a> »;</p></li>
<li><p>Un IV : private static final String STATIC_IV = « LJo+0sanl6E3cvCHCRwyIg== »;</p></li>
</ul>
<p>La fonction de création du hashDeviceID :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">public final String hashDeviceId(String model, String brand) {</span>
<span class="go">        String str = model + &#39;:&#39; + brand;</span>
<span class="go">        MessageDigest messageDigest = MessageDigest.getInstance(&quot;SHA-256&quot;);</span>
<span class="go">        Charset UTF_8 = StandardCharsets.UTF_8;</span>
<span class="go">        Intrinsics.checkNotNullExpressionValue(UTF_8, &quot;UTF_8&quot;);</span>
<span class="go">        byte[] bytes = str.getBytes(UTF_8);</span>
<span class="go">        Intrinsics.checkNotNullExpressionValue(bytes, &quot;this as java.lang.String).getBytes(charset)&quot;);</span>
<span class="go">        String encodeToString = Base64.encodeToString(messageDigest.digest(bytes), 2);</span>
<span class="go">        Intrinsics.checkNotNullExpressionValue(encodeToString, &quot;encodeToString(...)&quot;);</span>
<span class="go">        return encodeToString;</span>
<span class="go">    }</span>
</pre></div>
</div>
<p>Et la fonction de déchiffrement des messages :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">public final String decryptMessage(String encryptedMessage) {</span>
<span class="go">    try {</span>
<span class="go">        String MODEL = Build.MODEL;</span>
<span class="go">        Intrinsics.checkNotNullExpressionValue(MODEL, &quot;MODEL&quot;);</span>
<span class="go">        String BRAND = Build.BRAND;</span>
<span class="go">        Intrinsics.checkNotNullExpressionValue(BRAND, &quot;BRAND&quot;);</span>
<span class="go">        byte[] deriveKey = deriveKey(hashDeviceId(MODEL, BRAND), STATIC_SALT);</span>
<span class="go">        byte[] decode = Base64.decode(STATIC_IV, 0);</span>
<span class="go">        Cipher cipher = Cipher.getInstance(&quot;AES/CBC/PKCS5Padding&quot;);</span>
<span class="go">        cipher.init(2, new SecretKeySpec(deriveKey, &quot;AES&quot;), new IvParameterSpec(decode));</span>
<span class="go">        byte[] doFinal = cipher.doFinal(Base64.decode(encryptedMessage, 0));</span>
<span class="go">        Intrinsics.checkNotNull(doFinal);</span>
<span class="go">        Charset UTF_8 = StandardCharsets.UTF_8;</span>
<span class="go">        Intrinsics.checkNotNullExpressionValue(UTF_8, &quot;UTF_8&quot;);</span>
<span class="go">        return new String(doFinal, UTF_8);</span>
<span class="go">    } catch (Exception e) {</span>
<span class="go">        Log.e(&quot;DECRYPT_ERROR&quot;, &quot;Error decrypting message&quot;, e);</span>
<span class="go">        return &quot;[Encrypted] This message was encrypted with old device credentials&quot;;</span>
<span class="go">    }</span>
<span class="go">}</span>
</pre></div>
</div>
<p>On va récupérer la liste des devices google : <a class="reference external" href="https://storage.googleapis.com/play_public/supported_devices.html">https://storage.googleapis.com/play_public/supported_devices.html</a></p>
<p>Google;guybrush
Google;skyrim
Google;zork
Google;grunt
Google;kalista
Google;Acer Chromebook 14 (CB3-431)
Google;Chromebook 14 (CB3-431)
Google;Google Chromebook Pixel (2015)
Google;Chromebox Reference
Google;fizz
Google;puff
Google;Chromecast
Google;Chromecast HD
Google;AOSP on IA Emulator
Google;Android SDK built for x86
Google;Android SDK built for x86_64
Google;GT-I9505G
Google;sdk_gphone_x86
Google;Android SDK built for x86_64
Google;Car on x86_64 emulator
Google;HPE device
Google;Google TV Streamer
Google;brya
Google;brask
Google;nissa
Google;rammus
Google;coral
Google;ASUS Chromebook C213NA
Google;Intel Apollo Lake Chromebook
Google;reef
Google;Braswell Chrome OS Device
Google;Intel Braswell Chromebook
Google;Intel Braswell Chromebook
Google;hatch
Google;octopus
Google;dedede
Google;keeby
Google;nami
Google;rex
Google;volteer
Google;jacuzzi
Google;kukui
Google;corsola
Google;staryu
Google;geralt
Google;asurada
Google;cherry
Google;Lenovo N23 Yoga/Flex 11 Chromebook
Google;Mediatek MT8173 Chromebook
Google;Mediatek MTK8173 Chromebook
Google;Pixel
Google;Pixel 2
Google;Pixel 2 XL
Google;Pixel 3
Google;Pixel 3 XL
Google;Pixel 3a
Google;Pixel 3a XL
Google;Pixel 4
Google;Pixel 4 XL
Google;Pixel 4a
Google;Pixel 4a (5G)
Google;Pixel 5
Google;Pixel 5a
Google;Pixel 6
Google;Pixel 6 Pro
Google;Pixel 6a
Google;Pixel 7
Google;Pixel 7 Pro
Google;Pixel 7a
Google;Pixel 8
Google;Pixel 8 Pro
Google;Pixel 8a
Google;Pixel 9
Google;Pixel 9 Pro
Google;Pixel 9 Pro Fold
Google;Pixel 9 Pro XL
Google;Pixel 9a
Google;Pixel C
Google;Pixel Fold
Google;Google Pixel Slate
Google;Pixel Slate
Google;nocturne
Google;Pixel Tablet
Google;Google Pixel Watch
Google;Google Pixel Watch
Google;Google Pixel Watch 2
Google;Google Pixel Watch 2
Google;Pixel XL
Google;Pixel Watch 3
Google;Pixel Watch 3
Google;Pixel Watch 3
Google;Pixel Watch 3
Google;Google Pixelbook Go
Google;atlas
Google;Google Pixelbook
Google;Project Tango Tablet Development Kit
Google;Yellowstone
Google;trogdor
Google;trogdor64
Google;strongbad
Google;RK3288 Chrome OS Device
Google;Rockchip RK3288 Chromebook
Google;RK3288 Chrome OS Device
Google;Rockchip RK3288 Chromebook
Google;sdk_gphone64_x86_64
Google;Automotive SDK built for x86_64
Google;AOSP on x86
Google;Automotive SDK built for x86</p>
<p>On fait un script python qui permet de détecter le bon couple Model / Brand : Yellowstone/Google</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">unpad</span>

<span class="c1"># === Constantes ===</span>
<span class="n">STATIC_SALT</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;s3cr3t_s@lt&#39;</span>  <span class="c1"># Sel statique</span>
<span class="n">STATIC_IV</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="s2">&quot;LJo+0sanl6E3cvCHCRwyIg==&quot;</span><span class="p">)</span>  <span class="c1"># IV statique</span>

<span class="k">def</span> <span class="nf">hash_device_id</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">brand</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hachage SHA-256 du modèle et de la marque, puis encodage en Base64.&quot;&quot;&quot;</span>
    <span class="c1"># Concatenation du modèle et de la marque</span>
    <span class="n">device_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Hachage SHA-256</span>
    <span class="n">sha256_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">device_id</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>

    <span class="c1"># Encodage du hash en Base64</span>
    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">sha256_hash</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">derive_key</span><span class="p">(</span><span class="n">device_id_b64</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">salt</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dérive la clé en concaténant le device_id en Base64 et le sel, puis en hachant le tout avec SHA-256.&quot;&quot;&quot;</span>
    <span class="c1"># Concaténation du device_id en Base64 et du sel (en tant que chaînes de caractères)</span>
    <span class="n">str_to_hash</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">device_id_b64</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">salt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Hachage SHA-256 pour dériver la clé</span>
    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">str_to_hash</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">decrypt_message</span><span class="p">(</span><span class="n">encrypted_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">brand</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Déchiffre le message en utilisant AES CBC et la clé dérivées.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Génération de la clé à partir du modèle et de la marque</span>
        <span class="n">device_hash_b64</span> <span class="o">=</span> <span class="n">hash_device_id</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">brand</span><span class="p">)</span>
        <span class="n">derived_key</span> <span class="o">=</span> <span class="n">derive_key</span><span class="p">(</span><span class="n">device_hash_b64</span><span class="p">,</span> <span class="n">STATIC_SALT</span><span class="p">)</span>

        <span class="c1"># Décodage du message chiffré</span>
        <span class="n">encrypted_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">encrypted_message</span><span class="p">)</span>

        <span class="c1"># Décryptage avec AES CBC</span>
        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">derived_key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">STATIC_IV</span><span class="p">)</span>
        <span class="n">decrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_bytes</span><span class="p">)</span>

        <span class="c1"># Suppression du padding</span>
        <span class="n">plaintext</span> <span class="o">=</span> <span class="n">unpad</span><span class="p">(</span><span class="n">decrypted</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">plaintext</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Gestion des erreurs</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Erreur de déchiffrement pour </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s2"> : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;[Encrypted] Ce message a été chiffré avec de anciennes informations d&#39;appareil.&quot;</span>

<span class="k">def</span> <span class="nf">process_devices</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">encrypted_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Processus principal pour parcourir les modèles et marques et déchiffrer les messages.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">brand</span><span class="p">,</span> <span class="n">model</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🔍 Décryptage pour </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">decrypted_message</span> <span class="o">=</span> <span class="n">decrypt_message</span><span class="p">(</span><span class="n">encrypted_message</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">brand</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Message déchiffré pour </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">decrypted_message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># === Point d’entrée ===</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Exemple de message chiffré (à remplacer par le message réel)</span>
    <span class="n">encrypted_message</span> <span class="o">=</span> <span class="s2">&quot;M2geCVKOzPlyug9p9DvthxPip0oe9BPiT2sDfFhWy7iC3+JQI4SfO7+SLAlFSUmu8LoGj1hrUWil/uNXvc+5mKBMrRNFQT8ijBK14P0Z8qA=&quot;</span>

    <span class="c1"># Chemin vers le fichier devices.txt</span>
    <span class="n">devices_file</span> <span class="o">=</span> <span class="s2">&quot;devices.txt&quot;</span>

    <span class="c1"># Traitement des appareils</span>
    <span class="n">process_devices</span><span class="p">(</span><span class="n">devices_file</span><span class="p">,</span> <span class="n">encrypted_message</span><span class="p">)</span>
</pre></div>
</div>
<p>On peut maintenant déchiffrer le reste des messages avec ce script :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">from</span> <span class="nn">Crypto.Cipher</span> <span class="kn">import</span> <span class="n">AES</span>
<span class="kn">from</span> <span class="nn">Crypto.Util.Padding</span> <span class="kn">import</span> <span class="n">unpad</span>

<span class="c1"># === Constantes ===</span>
<span class="n">STATIC_SALT</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;s3cr3t_s@lt&#39;</span>  <span class="c1"># Sel statique</span>
<span class="n">STATIC_IV</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="s2">&quot;LJo+0sanl6E3cvCHCRwyIg==&quot;</span><span class="p">)</span>  <span class="c1"># IV statique</span>

<span class="k">def</span> <span class="nf">hash_device_id</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">brand</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Hachage SHA-256 du modèle et de la marque, puis encodage en Base64.&quot;&quot;&quot;</span>
    <span class="c1"># Concatenation du modèle et de la marque</span>
    <span class="n">device_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">brand</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Hachage SHA-256</span>
    <span class="n">sha256_hash</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">device_id</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>

    <span class="c1"># Encodage du hash en Base64</span>
    <span class="k">return</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">sha256_hash</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">derive_key</span><span class="p">(</span><span class="n">device_id_b64</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">salt</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dérive la clé en concaténant le device_id en Base64 et le sel, puis en hachant le tout avec SHA-256.&quot;&quot;&quot;</span>
    <span class="c1"># Concaténation du device_id en Base64 et du sel (en tant que chaînes de caractères)</span>
    <span class="n">str_to_hash</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">device_id_b64</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">salt</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="c1"># Hachage SHA-256 pour dériver la clé</span>
    <span class="k">return</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">str_to_hash</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">decrypt_message</span><span class="p">(</span><span class="n">encrypted_message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">brand</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Déchiffre le message en utilisant AES CBC et la clé dérivées.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Génération de la clé à partir du modèle et de la marque</span>
        <span class="n">device_hash_b64</span> <span class="o">=</span> <span class="n">hash_device_id</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">brand</span><span class="p">)</span>
        <span class="n">derived_key</span> <span class="o">=</span> <span class="n">derive_key</span><span class="p">(</span><span class="n">device_hash_b64</span><span class="p">,</span> <span class="n">STATIC_SALT</span><span class="p">)</span>

        <span class="c1"># Décodage du message chiffré</span>
        <span class="n">encrypted_bytes</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">encrypted_message</span><span class="p">)</span>

        <span class="c1"># Décryptage avec AES CBC</span>
        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">derived_key</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">STATIC_IV</span><span class="p">)</span>
        <span class="n">decrypted</span> <span class="o">=</span> <span class="n">cipher</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">encrypted_bytes</span><span class="p">)</span>

        <span class="c1"># Suppression du padding</span>
        <span class="n">plaintext</span> <span class="o">=</span> <span class="n">unpad</span><span class="p">(</span><span class="n">decrypted</span><span class="p">,</span> <span class="n">AES</span><span class="o">.</span><span class="n">block_size</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">plaintext</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># Gestion des erreurs</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Erreur de déchiffrement : </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;[Encrypted] Ce message a été chiffré avec de anciennes informations d&#39;appareil.&quot;</span>

<span class="k">def</span> <span class="nf">decrypt_all_messages</span><span class="p">(</span><span class="n">messages</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">brand</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Déchiffre tous les messages dans la liste.&quot;&quot;&quot;</span>
    <span class="n">decrypted_messages</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">messages</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;isEncrypted&#39;</span><span class="p">]:</span>
            <span class="n">decrypted_text</span> <span class="o">=</span> <span class="n">decrypt_message</span><span class="p">(</span><span class="n">message</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">],</span> <span class="n">model</span><span class="p">,</span> <span class="n">brand</span><span class="p">)</span>
            <span class="n">decrypted_messages</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">],</span>
                <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span>
                <span class="s2">&quot;decrypted_content&quot;</span><span class="p">:</span> <span class="n">decrypted_text</span>
            <span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">decrypted_messages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>  <span class="c1"># Message non chiffré</span>
    <span class="k">return</span> <span class="n">decrypted_messages</span>

<span class="c1"># === Point d’entrée ===</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Messages chiffrés à déchiffrer (les données JSON fournies)</span>
    <span class="n">encrypted_messages</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;M2geCVKOzPlyug9p9DvthxPip0oe9BPiT2sDfFhWy7iC3+JQI4SfO7+SLAlFSUmu8LoGj1hrUWil/uNXvc+5mKBMrRNFQT8ijBK14P0Z8qA=&quot;</span><span class="p">,</span> <span class="s2">&quot;isEncrypted&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;Agent-02&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-01 08:00:00&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;//5PBsYWhHlgqhVgG1omUyevzmlErLZVsTCLO78Rbb9qBMPnsKCS5/RZ4GEdWRBPiZ4BtO5h7j2PuIutfqf7ag==&quot;</span><span class="p">,</span> <span class="s2">&quot;isEncrypted&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;Agent-1337&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-01 10:00:00&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;2uNMSnJZa5JExhYgNA+V3RAiafhuLkj8Jnr4U+lSZOrrpMWjyA13w0Do3IIPcVBgK070rmweRKX/GkCAxat4i3JfWk1UvWNSmEZbHQlFznR7VFW6FKK84iJKhiDOp8Tk&quot;</span><span class="p">,</span> <span class="s2">&quot;isEncrypted&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;Agent-01&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-02 15:30:00&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Swz/ycaTlv3JM9iKJHaY+f1SRyKvfQ5miG6I0/tUb8bvbOO+wyU5hi+bGsmcJD3141FrmrDcBQhtWpYimospymABi3bzvPPi01rPI8pNBq8=&quot;</span><span class="p">,</span> <span class="s2">&quot;isEncrypted&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;Agent-02&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-03 13:20:00&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;NAe44oieygG7xzLQT3j0vN+0NoPNUu0TAaid9Az3IlpcKwR0lSKaPT8F4y1zpbArWFIGpgzsPZtPAwL50qocTRMG/g5u+/wcc1nxmhBjCbg=&quot;</span><span class="p">,</span> <span class="s2">&quot;isEncrypted&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;Agent-04&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-04 08:30:00&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;dfeKlZP/gIntHySBYine2YUlNiX3LjlMOLu7y9tgprFyJIIcQpfghlQXut6cJUG2wtzGBVQUm7ITdpLNeVaZjamQHhPWEtNIJE/xtFg66Klui1qCKYKSrmZ4wm1CG/ZPy4csqbM28Ur8dts7XoV5FA==&quot;</span><span class="p">,</span> <span class="s2">&quot;isEncrypted&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;Agent-04&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-05 16:45:00&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;HgVONjPe9UpULkg8e9Ps5++m3t4r6RK0pPfMUQJK/Ok5NinC3UJqkltlEukrvehfyas/uOQygGwMFYdRWT6m4gQBq/TdHf9Xpf4kLJl+o9l2shuwBGFpayRLMkRZ0yX1&quot;</span><span class="p">,</span> <span class="s2">&quot;isEncrypted&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;Agent-03&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-06 11:15:00&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;M+bWr4Az5IbaOw4oGRKZ0pWrGjK7hhLeXVpOiaOAFw91v8KGwhl5b6bXoEl3qqz5APuiy9gLQp7x7GGDod4mLOBWRby48g2RjABqGa6mg3g=&quot;</span><span class="p">,</span> <span class="s2">&quot;isEncrypted&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;Agent-01&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-06 14:20:00&quot;</span><span class="p">},</span>
        <span class="p">{</span><span class="s2">&quot;content&quot;</span><span class="p">:</span> <span class="s2">&quot;Z56plvPjUwczUuTZajCJNqvxB0ArZ9vk38PJnGHSlayR6xe9la8wB4sMOdChcOozbXsjwMRY78wuogxsY57R3iiKe1O3nDpwt3y85BXl9sLEF15wZ8wxc5IfpjVUnRJT&quot;</span><span class="p">,</span> <span class="s2">&quot;isEncrypted&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;sender&quot;</span><span class="p">:</span> <span class="s2">&quot;Agent-00&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2025-04-07 09:00:00&quot;</span><span class="p">}</span>
    <span class="p">]</span>

    <span class="c1"># Déchiffrement de tous les messages</span>
    <span class="n">decrypted_messages</span> <span class="o">=</span> <span class="n">decrypt_all_messages</span><span class="p">(</span><span class="n">encrypted_messages</span><span class="p">,</span> <span class="s2">&quot;Yellowstone&quot;</span><span class="p">,</span> <span class="s2">&quot;Google&quot;</span><span class="p">)</span>

    <span class="c1"># Affichage des messages déchiffrés</span>
    <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">decrypted_messages</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sender: </span><span class="si">{</span><span class="n">msg</span><span class="p">[</span><span class="s1">&#39;sender&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | Timestamp: </span><span class="si">{</span><span class="n">msg</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> | Decrypted Content: </span><span class="si">{</span><span class="n">msg</span><span class="p">[</span><span class="s1">&#39;decrypted_content&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Résultalt :</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Sender: Agent-02 | Timestamp: 2025-04-01 08:00:00 | Decrypted Content: Target acquired. Hospital network vulnerable. Initiating ransomware deployment.</span>
<span class="go">Sender: Agent-1337 | Timestamp: 2025-04-01 10:00:00 | Decrypted Content: Keep this safe. RM{788e6f3e63e945c2a0f506da448e0244ac94f7c4}</span>
<span class="go">Sender: Agent-01 | Timestamp: 2025-04-02 15:30:00 | Decrypted Content: New target identified. School district network. Estimated payout: 500k in crypto.</span>
<span class="go">Sender: Agent-02 | Timestamp: 2025-04-03 13:20:00 | Decrypted Content: New ransomware strain ready for deployment. Testing phase complete.</span>
<span class="go">Sender: Agent-04 | Timestamp: 2025-04-04 08:30:00 | Decrypted Content: Security patch released. Need to modify attack vector. Meeting at usual place.</span>
<span class="go">Sender: Agent-04 | Timestamp: 2025-04-05 16:45:00 | Decrypted Content: New zero-day exploit in a linux binary discovered. Perfect for next operation. Details incoming.</span>
<span class="go">Sender: Agent-03 | Timestamp: 2025-04-06 11:15:00 | Decrypted Content: [Encrypted] Ce message a été chiffré avec de anciennes informations d&#39;appareil.</span>
<span class="go">Sender: Agent-01 | Timestamp: 2025-04-06 14:20:00 | Decrypted Content: [Encrypted] Ce message a été chiffré avec de anciennes informations d&#39;appareil.</span>
<span class="go">Sender: Agent-00 | Timestamp: 2025-04-07 09:00:00 | Decrypted Content: [Encrypted] Ce message a été chiffré avec de anciennes informations d&#39;appareil.</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="Mission4.html" class="btn btn-neutral float-left" title="Mission 4" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="Mission-finale.html" class="btn btn-neutral float-right" title="Mission finale" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2025, Kubow.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>